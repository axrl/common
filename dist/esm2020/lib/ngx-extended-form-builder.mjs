import { UntypedFormGroup, UntypedFormArray, UntypedFormControl } from "@angular/forms";
import { Observable } from "rxjs";
;
function getValidatorsOrNull(key, keysValidator, addLift = false) {
    const result = keysValidator && keysValidator.has(key) ? keysValidator.get(key) : null;
    if (addLift) {
        if (result && Array.isArray(result)) {
            result.push(liftErrors);
            return result;
        }
        else {
            return result ? result : [liftErrors];
        }
    }
    else {
        return result;
    }
    ;
}
function makeFormGroup(source, internalKey, keysValidator, asyncKeysValidator) {
    return source instanceof UntypedFormGroup ? source : Object.entries(source).reduce((accumulator, entry) => {
        const key = entry[0];
        const value = entry[1];
        if (!(value instanceof Observable)) {
            accumulator.addControl(key, !!value && value instanceof UntypedFormControl || value instanceof UntypedFormGroup || value instanceof UntypedFormArray ?
                value :
                makeForm(value, makeNewMainFormValidatorsMap(key, keysValidator), makeNewMainFormValidatorsMap(key, asyncKeysValidator)));
        }
        ;
        return accumulator;
    }, new UntypedFormGroup({}, getValidatorsOrNull(internalKey, keysValidator, true), getValidatorsOrNull(internalKey, asyncKeysValidator, false)));
}
function makeNewMainFormValidatorsMap(key, oldMap) {
    if (!oldMap || key === 'mainFormValidators' || key === 'mainFormValidatorsItems') {
        return oldMap;
    }
    else {
        if (!oldMap.has(key) && !oldMap.has(`${key}Items`)) {
            return new Map(Array.from(oldMap.entries()).filter(item => item[0] !== 'mainFormValidators' && item[0] !== 'mainFormValidatorsItems').map(([entryKey, entryValue]) => [entryKey.startsWith(`${key}.`) ? entryKey.replace(`${key}.`, '') : entryKey, entryValue]));
        }
        else {
            const filterPredicate = oldMap.has('mainFormValidators') ?
                oldMap.has('mainFormValidatorsItems') ?
                    (item) => item[0] !== key && item[0] !== 'mainFormValidators' && item[0] !== 'mainFormValidatorsItems' :
                    (item) => item[0] !== key && item[0] !== 'mainFormValidators' :
                oldMap.has('mainFormValidatorsItems') ?
                    (item) => item[0] !== key && item[0] !== 'mainFormValidatorsItems' :
                    (item) => item[0] !== key;
            const newMainValidatorsArray = oldMap.has(key) ?
                oldMap.has(`${key}Items`) ?
                    [
                        ['mainFormValidators', oldMap.get(key)],
                        ['mainFormValidatorsItems', oldMap.get(`${key}Items`)]
                    ] :
                    [
                        ['mainFormValidators', oldMap.get(key)],
                    ] :
                oldMap.has(`${key}Items`) ?
                    [
                        ['mainFormValidatorsItems', oldMap.get(`${key}Items`)]
                    ] :
                    [];
            return new Map([
                ...newMainValidatorsArray,
                ...Array.from(oldMap.entries()).filter(filterPredicate).map(([entryKey, entryValue]) => [entryKey.startsWith(`${key}.`) ? entryKey.replace(`${key}.`, '') : entryKey, entryValue])
            ]);
        }
        ;
    }
    ;
}
export function makeForm(source, keysValidator, asyncKeysValidator) {
    const form = !!source && (typeof source === 'object' || typeof source === 'function') ?
        source instanceof Array ?
            new UntypedFormArray(source.map(item => {
                const itemForm = makeForm(item, makeNewMainFormValidatorsMap('mainFormValidatorsItems', keysValidator), makeNewMainFormValidatorsMap('mainFormValidatorsItems', asyncKeysValidator));
                return itemForm;
            }), getValidatorsOrNull('mainFormValidators', keysValidator, true), getValidatorsOrNull('mainFormValidators', asyncKeysValidator, false)) :
            makeFormGroup(source, 'mainFormValidators', keysValidator, asyncKeysValidator) :
        new UntypedFormControl({
            disabled: keysValidator?.has('mainFormValidators') && 'disabled' in (keysValidator.get('mainFormValidators')) ?
                keysValidator.get('mainFormValidators').disabled :
                false,
            value: !!source && typeof source == 'string' && (source.includes('0001-01-01') || source.includes('1970-01-01')) ? null : source
        }, getValidatorsOrNull('mainFormValidators', keysValidator, false), getValidatorsOrNull('mainFormValidators', asyncKeysValidator, false));
    return form;
}
;
function liftErrors(control) {
    if (control instanceof UntypedFormControl) {
        return null;
    }
    else {
        const allControls = control instanceof UntypedFormGroup ?
            Object.values(control.controls) :
            control instanceof UntypedFormArray ?
                control.controls :
                [];
        const invalidControls = allControls.filter(control => control.status === 'INVALID');
        return invalidControls.length === 0 ? null : invalidControls.reduce((accumulator, current) => {
            if (current.errors) {
                addValidationErrors(current.errors, accumulator);
            }
            ;
            return accumulator;
        }, {});
    }
}
export function liftValidationErrors(control) {
    const allControls = control instanceof UntypedFormGroup ?
        Object.values(control.controls) :
        control instanceof UntypedFormArray ?
            control.controls :
            [];
    const invalidControls = allControls.filter(control => control.status === 'INVALID');
    const errors = invalidControls.length === 0 ? {} : invalidControls.reduce((accumulator, current) => {
        if (current.errors) {
            addValidationErrors(current.errors, accumulator);
        }
        ;
        const innerErrors = liftValidationErrors(current);
        if (innerErrors) {
            addValidationErrors(innerErrors, accumulator);
        }
        ;
        return accumulator;
    }, {});
    return Object.values(errors).length === 0 ? null : errors;
}
;
function addValidationErrors(additionErrors, currentErrors) {
    Object.entries(additionErrors).forEach(entry => currentErrors[entry[0]] = entry[1]);
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmd4LWV4dGVuZGVkLWZvcm0tYnVpbGRlci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3Byb2plY3RzL25neC1leHRlbmRlZC1mb3JtLWJ1aWxkZXIvc3JjL2xpYi9uZ3gtZXh0ZW5kZWQtZm9ybS1idWlsZGVyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxnQkFBZ0IsRUFBRSxnQkFBZ0IsRUFBRSxrQkFBa0IsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBRXhGLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxNQUFNLENBQUM7QUFJakMsQ0FBQztBQUVGLFNBQVMsbUJBQW1CLENBQzFCLEdBQVcsRUFBRSxhQUE4QixFQUFFLFVBQW1CLEtBQUs7SUFFckUsTUFBTSxNQUFNLEdBQUcsYUFBYSxJQUFJLGFBQWEsQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLGFBQWEsQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQztJQUN2RixJQUFJLE9BQU8sRUFBRTtRQUNYLElBQUksTUFBTSxJQUFJLEtBQUssQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDLEVBQUU7WUFDbkIsTUFBTyxDQUFDLElBQUksQ0FBYyxVQUFVLENBQUMsQ0FBQztZQUN0RCxPQUFVLE1BQU0sQ0FBQztTQUNsQjthQUFNO1lBQ0wsT0FBTyxNQUFNLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUksQ0FBQyxVQUFVLENBQUMsQ0FBQTtTQUN6QztLQUNGO1NBQU07UUFDTCxPQUFPLE1BQU0sQ0FBQztLQUNmO0lBQUEsQ0FBQztBQUNKLENBQUM7QUFFRCxTQUFTLGFBQWEsQ0FDcEIsTUFBVyxFQUNYLFdBQW1CLEVBQ25CLGFBQTBFLEVBQzFFLGtCQUEyRDtJQUUzRCxPQUFPLE1BQU0sWUFBWSxnQkFBZ0IsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxNQUFN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QUMsQ0FBQyxNQUFNLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQztBQUM1RCxDQUFDO0FBQUEsQ0FBQztBQUVGLFNBQVMsbUJBQW1CLENBQUMsY0FBZ0MsRUFBRSxhQUErQjtJQUM1RixNQUFNLENBQUMsT0FBTyxDQUFDLGNBQWMsQ0FBQyxDQUFDLE9BQU8sQ0FDcEMsS0FBSyxDQUFDLEVBQUUsQ0FBQyxhQUFhLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUM1QyxDQUFDO0FBQ0osQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFVudHlwZWRGb3JtR3JvdXAsIFVudHlwZWRGb3JtQXJyYXksIFVudHlwZWRGb3JtQ29udHJvbCB9IGZyb20gXCJAYW5ndWxhci9mb3Jtc1wiO1xuaW1wb3J0IHR5cGUgeyBWYWxpZGF0b3JGbiwgVmFsaWRhdGlvbkVycm9ycywgQWJzdHJhY3RDb250cm9sLCBBc3luY1ZhbGlkYXRvckZuLCBBYnN0cmFjdENvbnRyb2xPcHRpb25zIH0gZnJvbSBcIkBhbmd1bGFyL2Zvcm1zXCI7XG5pbXBvcnQgeyBPYnNlcnZhYmxlIH0gZnJvbSBcInJ4anNcIjtcblxuaW50ZXJmYWNlIEV4dGVuZGVkQ29udHJvbE9wdGlvbnMgZXh0ZW5kcyBBYnN0cmFjdENvbnRyb2xPcHRpb25zIHtcbiAgZGlzYWJsZWQ/OiBib29sZWFuLFxufTtcblxuZnVuY3Rpb24gZ2V0VmFsaWRhdG9yc09yTnVsbDxUIGV4dGVuZHMgVmFsaWRhdG9yRm5bXSB8IEFzeW5jVmFsaWRhdG9yRm5bXSB8IEV4dGVuZGVkQ29udHJvbE9wdGlvbnMgfCBudWxsPihcbiAga2V5OiBzdHJpbmcsIGtleXNWYWxpZGF0b3I/OiBNYXA8c3RyaW5nLCBUPiwgYWRkTGlmdDogYm9vbGVhbiA9IGZhbHNlXG4pOiBUIHwgdW5kZWZpbmVkIHwgbnVsbCB7XG4gIGNvbnN0IHJlc3VsdCA9IGtleXNWYWxpZGF0b3IgJiYga2V5c1ZhbGlkYXRvci5oYXMoa2V5KSA/IGtleXNWYWxpZGF0b3IuZ2V0KGtleSkgOiBudWxsO1xuICBpZiAoYWRkTGlmdCkge1xuICAgIGlmIChyZXN1bHQgJiYgQXJyYXkuaXNBcnJheShyZXN1bHQpKSB7XG4gICAgICAoPFZhbGlkYXRvckZuW10+cmVzdWx0KS5wdXNoKDxWYWxpZGF0b3JGbj5saWZ0RXJyb3JzKTtcbiAgICAgIHJldHVybiA8VD5yZXN1bHQ7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiByZXN1bHQgPyByZXN1bHQgOiA8VD5bbGlmdEVycm9yc11cbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfTtcbn1cblxuZnVuY3Rpb24gbWFrZUZvcm1Hcm91cChcbiAgc291cmNlOiBhbnksXG4gIGludGVybmFsS2V5OiBzdHJpbmcsXG4gIGtleXNWYWxpZGF0b3I/OiBNYXA8c3RyaW5nLCBWYWxpZGF0b3JGbltdIHwgRXh0ZW5kZWRDb250cm9sT3B0aW9ucyB8IG51bGw+LFxuICBhc3luY0tleXNWYWxpZGF0b3I/OiBNYXA8c3RyaW5nLCBBc3luY1ZhbGlkYXRvckZuW10gfCBudWxsPlxuKTogVW50eXBlZEZvcm1Hcm91cCB7XG4gIHJldHVybiBzb3VyY2UgaW5zdGFuY2VvZiBVbnR5cGVkRm9ybUdyb3VwID8gc291cmNlIDogT2JqZWN0LmVudHJpZXMoc291cmNlKS5yZWR1Y2UoXG4gICAgKGFjY3VtdWxhdG9yOiBVbnR5cGVkRm9ybUdyb3VwLCBlbnRyeTogW3N0cmluZywgdW5rbm93bl0pID0+IHtcbiAgICAgIGNvbnN0IGtleSA9IGVudHJ5WzBdO1xuICAgICAgY29uc3QgdmFsdWUgPSBlbnRyeVsxXTtcbiAgICAgIGlmICghKHZhbHVlIGluc3RhbmNlb2YgT2JzZXJ2YWJsZSkpIHtcbiAgICAgICAgYWNjdW11bGF0b3IuYWRkQ29udHJvbChcbiAgICAgICAgICBrZXksXG4gICAgICAgICAgISF2YWx1ZSAmJiB2YWx1ZSBpbnN0YW5jZW9mIFVudHlwZWRGb3JtQ29udHJvbCB8fCB2YWx1ZSBpbnN0YW5jZW9mIFVudHlwZWRGb3JtR3JvdXAgfHwgdmFsdWUgaW5zdGFuY2VvZiBVbnR5cGVkRm9ybUFycmF5ID9cbiAgICAgICAgICAgIHZhbHVlIDpcbiAgICAgICAgICAgIG1ha2VGb3JtKFxuICAgICAgICAgICAgICB2YWx1ZSxcbiAgICAgICAgICAgICAgbWFrZU5ld01haW5Gb3JtVmFsaWRhdG9yc01hcChrZXksIGtleXNWYWxpZGF0b3IpLFxuICAgICAgICAgICAgICBtYWtlTmV3TWFpbkZvcm1WYWxpZGF0b3JzTWFwKGtleSwgYXN5bmNLZXlzVmFsaWRhdG9yKSxcbiAgICAgICAgICAgIClcbiAgICAgICAgKTtcbiAgICAgIH07XG4gICAgICByZXR1cm4gYWNjdW11bGF0b3I7XG4gICAgfSwgbmV3IFVudHlwZWRGb3JtR3JvdXAoe30sXG4gICAgICBnZXRWYWxpZGF0b3JzT3JOdWxsKGludGVybmFsS2V5LCBrZXlzVmFsaWRhdG9yLCB0cnVlKSxcbiAgICAgIGdldFZhbGlkYXRvcnNPck51bGwoaW50ZXJuYWxLZXksIGFzeW5jS2V5c1ZhbGlkYXRvciwgZmFsc2UpXG4gICAgKVxuICApO1xufVxuXG5mdW5jdGlvbiBtYWtlTmV3TWFpbkZvcm1WYWxpZGF0b3JzTWFwPFQgZXh0ZW5kcyBWYWxpZGF0b3JGbltdIHwgQXN5bmNWYWxpZGF0b3JGbltdIHwgRXh0ZW5kZWRDb250cm9sT3B0aW9ucyB8IG51bGw+KFxuICBrZXk6IHN0cmluZywgb2xkTWFwPzogTWFwPHN0cmluZywgVD4sXG4pOiBNYXA8c3RyaW5nLCBUPiB8IHVuZGVmaW5lZCB7XG4gIGlmICghb2xkTWFwIHx8IGtleSA9PT0gJ21haW5Gb3JtVmFsaWRhdG9ycycgfHwga2V5ID09PSAnbWFpbkZvcm1WYWxpZGF0b3JzSXRlbXMnKSB7XG4gICAgcmV0dXJuIG9sZE1hcDtcbiAgfSBlbHNlIHtcbiAgICBpZiAoIW9sZE1hcC5oYXMoa2V5KSAmJiAhb2xkTWFwLmhhcyhgJHtrZXl9SXRlbXNgKSkge1xuICAgICAgcmV0dXJuIG5ldyBNYXA8c3RyaW5nLCBUPihcbiAgICAgICAgQXJyYXkuZnJvbShcbiAgICAgICAgICBvbGRNYXAuZW50cmllcygpXG4gICAgICAgICkuZmlsdGVyKFxuICAgICAgICAgIGl0ZW0gPT4gaXRlbVswXSAhPT0gJ21haW5Gb3JtVmFsaWRhdG9ycycgJiYgaXRlbVswXSAhPT0gJ21haW5Gb3JtVmFsaWRhdG9yc0l0ZW1zJ1xuICAgICAgICApLm1hcChcbiAgICAgICAgICAoW2VudHJ5S2V5LCBlbnRyeVZhbHVlXSkgPT4gW2VudHJ5S2V5LnN0YXJ0c1dpdGgoYCR7a2V5fS5gKSA/IGVudHJ5S2V5LnJlcGxhY2UoYCR7a2V5fS5gLCAnJykgOiBlbnRyeUtleSwgZW50cnlWYWx1ZV1cbiAgICAgICAgKVxuICAgICAgKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3QgZmlsdGVyUHJlZGljYXRlID0gb2xkTWFwLmhhcygnbWFpbkZvcm1WYWxpZGF0b3JzJykgP1xuICAgICAgICBvbGRNYXAuaGFzKCdtYWluRm9ybVZhbGlkYXRvcnNJdGVtcycpID9cbiAgICAgICAgICAoaXRlbTogW3N0cmluZywgVF0pID0+IGl0ZW1bMF0gIT09IGtleSAmJiBpdGVtWzBdICE9PSAnbWFpbkZvcm1WYWxpZGF0b3JzJyAmJiBpdGVtWzBdICE9PSAnbWFpbkZvcm1WYWxpZGF0b3JzSXRlbXMnIDpcbiAgICAgICAgICAoaXRlbTogW3N0cmluZywgVF0pID0+IGl0ZW1bMF0gIT09IGtleSAmJiBpdGVtWzBdICE9PSAnbWFpbkZvcm1WYWxpZGF0b3JzJyA6XG4gICAgICAgIG9sZE1hcC5oYXMoJ21haW5Gb3JtVmFsaWRhdG9yc0l0ZW1zJykgP1xuICAgICAgICAgIChpdGVtOiBbc3RyaW5nLCBUXSkgPT4gaXRlbVswXSAhPT0ga2V5ICYmIGl0ZW1bMF0gIT09ICdtYWluRm9ybVZhbGlkYXRvcnNJdGVtcycgOlxuICAgICAgICAgIChpdGVtOiBbc3RyaW5nLCBUXSkgPT4gaXRlbVswXSAhPT0ga2V5O1xuICAgICAgY29uc3QgbmV3TWFpblZhbGlkYXRvcnNBcnJheTogW3N0cmluZywgVF1bXSA9IG9sZE1hcC5oYXMoa2V5KSA/XG4gICAgICAgIG9sZE1hcC5oYXMoYCR7a2V5fUl0ZW1zYCkgP1xuICAgICAgICAgIFtcbiAgICAgICAgICAgIFsnbWFpbkZvcm1WYWxpZGF0b3JzJywgb2xkTWFwLmdldChrZXkpIV0sXG4gICAgICAgICAgICBbJ21haW5Gb3JtVmFsaWRhdG9yc0l0ZW1zJywgb2xkTWFwLmdldChgJHtrZXl9SXRlbXNgKSFdXG4gICAgICAgICAgXSA6XG4gICAgICAgICAgW1xuICAgICAgICAgICAgWydtYWluRm9ybVZhbGlkYXRvcnMnLCBvbGRNYXAuZ2V0KGtleSkhXSxcbiAgICAgICAgICBdIDpcbiAgICAgICAgb2xkTWFwLmhhcyhgJHtrZXl9SXRlbXNgKSA/XG4gICAgICAgICAgW1xuICAgICAgICAgICAgWydtYWluRm9ybVZhbGlkYXRvcnNJdGVtcycsIG9sZE1hcC5nZXQoYCR7a2V5fUl0ZW1zYCkhXVxuICAgICAgICAgIF0gOlxuICAgICAgICAgIFtdO1xuICAgICAgcmV0dXJuIG5ldyBNYXA8c3RyaW5nLCBUPihbXG4gICAgICAgIC4uLm5ld01haW5WYWxpZGF0b3JzQXJyYXksXG4gICAgICAgIC4uLkFycmF5LmZyb20oXG4gICAgICAgICAgb2xkTWFwLmVudHJpZXMoKVxuICAgICAgICApLmZpbHRlcihmaWx0ZXJQcmVkaWNhdGUpLm1hcDxbc3RyaW5nLCBUXT4oXG4gICAgICAgICAgKFtlbnRyeUtleSwgZW50cnlWYWx1ZV0pID0+IFtlbnRyeUtleS5zdGFydHNXaXRoKGAke2tleX0uYCkgPyBlbnRyeUtleS5yZXBsYWNlKGAke2tleX0uYCwgJycpIDogZW50cnlLZXksIGVudHJ5VmFsdWVdXG4gICAgICAgIClcbiAgICAgIF0pO1xuICAgIH07XG4gIH07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBtYWtlRm9ybTxULFxuICBSIGV4dGVuZHMgKFQgZXh0ZW5kcyBBcnJheTxhbnk+ID8gVW50eXBlZEZvcm1BcnJheSA6IFQgZXh0ZW5kcyBzdHJpbmcgfCBudW1iZXIgfCBib29sZWFuIHwgc3ltYm9sIHwgbnVsbCB8IHVuZGVmaW5lZCA/IFVudHlwZWRGb3JtQ29udHJvbCA6IFVudHlwZWRGb3JtR3JvdXBcbiAgKT4oXG4gICAgc291cmNlOiBULFxuICAgIGtleXNWYWxpZGF0b3I/OiBNYXA8c3RyaW5nLCBWYWxpZGF0b3JGbltdIHwgRXh0ZW5kZWRDb250cm9sT3B0aW9ucyB8IG51bGw+LFxuICAgIGFzeW5jS2V5c1ZhbGlkYXRvcj86IE1hcDxzdHJpbmcsIEFzeW5jVmFsaWRhdG9yRm5bXSB8IG51bGw+LFxuKTogUiB7XG4gIGNvbnN0IGZvcm0gPSAhIXNvdXJjZSAmJiAodHlwZW9mIHNvdXJjZSA9PT0gJ29iamVjdCcgfHwgdHlwZW9mIHNvdXJjZSA9PT0gJ2Z1bmN0aW9uJykgP1xuICAgIHNvdXJjZSBpbnN0YW5jZW9mIEFycmF5ID9cbiAgICAgIG5ldyBVbnR5cGVkRm9ybUFycmF5KFxuICAgICAgICBzb3VyY2UubWFwKFxuICAgICAgICAgIGl0ZW0gPT4ge1xuICAgICAgICAgICAgY29uc3QgaXRlbUZvcm0gPSBtYWtlRm9ybShcbiAgICAgICAgICAgICAgaXRlbSxcbiAgICAgICAgICAgICAgbWFrZU5ld01haW5Gb3JtVmFsaWRhdG9yc01hcCgnbWFpbkZvcm1WYWxpZGF0b3JzSXRlbXMnLCBrZXlzVmFsaWRhdG9yKSxcbiAgICAgICAgICAgICAgbWFrZU5ld01haW5Gb3JtVmFsaWRhdG9yc01hcCgnbWFpbkZvcm1WYWxpZGF0b3JzSXRlbXMnLCBhc3luY0tleXNWYWxpZGF0b3IpXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgcmV0dXJuIGl0ZW1Gb3JtO1xuICAgICAgICAgIH0pLFxuICAgICAgICBnZXRWYWxpZGF0b3JzT3JOdWxsKCdtYWluRm9ybVZhbGlkYXRvcnMnLCBrZXlzVmFsaWRhdG9yLCB0cnVlKSxcbiAgICAgICAgZ2V0VmFsaWRhdG9yc09yTnVsbCgnbWFpbkZvcm1WYWxpZGF0b3JzJywgYXN5bmNLZXlzVmFsaWRhdG9yLCBmYWxzZSlcbiAgICAgICkgOlxuICAgICAgbWFrZUZvcm1Hcm91cChzb3VyY2UsICdtYWluRm9ybVZhbGlkYXRvcnMnLCBrZXlzVmFsaWRhdG9yLCBhc3luY0tleXNWYWxpZGF0b3IpIDpcbiAgICBuZXcgVW50eXBlZEZvcm1Db250cm9sKHtcbiAgICAgIGRpc2FibGVkOiBrZXlzVmFsaWRhdG9yPy5oYXMoJ21haW5Gb3JtVmFsaWRhdG9ycycpICYmICdkaXNhYmxlZCcgaW4gKGtleXNWYWxpZGF0b3IuZ2V0KCdtYWluRm9ybVZhbGlkYXRvcnMnKSEpID9cbiAgICAgICAgKDxFeHRlbmRlZENvbnRyb2xPcHRpb25zPmtleXNWYWxpZGF0b3IuZ2V0KCdtYWluRm9ybVZhbGlkYXRvcnMnKSkuZGlzYWJsZWQgOlxuICAgICAgICBmYWxzZSxcbiAgICAgIHZhbHVlOiAhIXNvdXJjZSAmJiB0eXBlb2Ygc291cmNlID09ICdzdHJpbmcnICYmIChzb3VyY2UuaW5jbHVkZXMoJzAwMDEtMDEtMDEnKSB8fCBzb3VyY2UuaW5jbHVkZXMoJzE5NzAtMDEtMDEnKSkgPyBudWxsIDogc291cmNlXG4gICAgfSxcbiAgICAgIGdldFZhbGlkYXRvcnNPck51bGwoJ21haW5Gb3JtVmFsaWRhdG9ycycsIGtleXNWYWxpZGF0b3IsIGZhbHNlKSxcbiAgICAgIGdldFZhbGlkYXRvcnNPck51bGwoJ21haW5Gb3JtVmFsaWRhdG9ycycsIGFzeW5jS2V5c1ZhbGlkYXRvciwgZmFsc2UpXG4gICAgKTtcbiAgcmV0dXJuIDxSPmZvcm07XG59O1xuXG5mdW5jdGlvbiBsaWZ0RXJyb3JzKGNvbnRyb2w6IEFic3RyYWN0Q29udHJvbCk6IFZhbGlkYXRpb25FcnJvcnMgfCBudWxsIHtcbiAgaWYgKGNvbnRyb2wgaW5zdGFuY2VvZiBVbnR5cGVkRm9ybUNvbnRyb2wpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfSBlbHNlIHtcbiAgICBjb25zdCBhbGxDb250cm9scyA9IGNvbnRyb2wgaW5zdGFuY2VvZiBVbnR5cGVkRm9ybUdyb3VwID9cbiAgICAgIE9iamVjdC52YWx1ZXMoY29udHJvbC5jb250cm9scykgOlxuICAgICAgY29udHJvbCBpbnN0YW5jZW9mIFVudHlwZWRGb3JtQXJyYXkgP1xuICAgICAgICBjb250cm9sLmNvbnRyb2xzIDpcbiAgICAgICAgW107XG4gICAgY29uc3QgaW52YWxpZENvbnRyb2xzID0gYWxsQ29udHJvbHMuZmlsdGVyKGNvbnRyb2wgPT4gY29udHJvbC5zdGF0dXMgPT09ICdJTlZBTElEJyk7XG4gICAgcmV0dXJuIGludmFsaWRDb250cm9scy5sZW5ndGggPT09IDAgPyBudWxsIDogaW52YWxpZENvbnRyb2xzLnJlZHVjZShcbiAgICAgIChhY2N1bXVsYXRvciwgY3VycmVudCkgPT4ge1xuICAgICAgICBpZiAoY3VycmVudC5lcnJvcnMpIHtcbiAgICAgICAgICBhZGRWYWxpZGF0aW9uRXJyb3JzKGN1cnJlbnQuZXJyb3JzLCBhY2N1bXVsYXRvcik7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBhY2N1bXVsYXRvcjtcbiAgICAgIH0sIDxWYWxpZGF0aW9uRXJyb3JzPnt9XG4gICAgKTtcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gbGlmdFZhbGlkYXRpb25FcnJvcnMoY29udHJvbDogQWJzdHJhY3RDb250cm9sKTogVmFsaWRhdGlvbkVycm9ycyB8IG51bGwge1xuICBjb25zdCBhbGxDb250cm9scyA9IGNvbnRyb2wgaW5zdGFuY2VvZiBVbnR5cGVkRm9ybUdyb3VwID9cbiAgICBPYmplY3QudmFsdWVzKGNvbnRyb2wuY29udHJvbHMpIDpcbiAgICBjb250cm9sIGluc3RhbmNlb2YgVW50eXBlZEZvcm1BcnJheSA/XG4gICAgICBjb250cm9sLmNvbnRyb2xzIDpcbiAgICAgIFtdO1xuICBjb25zdCBpbnZhbGlkQ29udHJvbHMgPSBhbGxDb250cm9scy5maWx0ZXIoY29udHJvbCA9PiBjb250cm9sLnN0YXR1cyA9PT0gJ0lOVkFMSUQnKTtcbiAgY29uc3QgZXJyb3JzOiBWYWxpZGF0aW9uRXJyb3JzID0gaW52YWxpZENvbnRyb2xzLmxlbmd0aCA9PT0gMCA/IHt9IDogaW52YWxpZENvbnRyb2xzLnJlZHVjZShcbiAgICAoYWNjdW11bGF0b3IsIGN1cnJlbnQpID0+IHtcbiAgICAgIGlmIChjdXJyZW50LmVycm9ycykge1xuICAgICAgICBhZGRWYWxpZGF0aW9uRXJyb3JzKGN1cnJlbnQuZXJyb3JzLCBhY2N1bXVsYXRvcik7XG4gICAgICB9O1xuICAgICAgY29uc3QgaW5uZXJFcnJvcnMgPSBsaWZ0VmFsaWRhdGlvbkVycm9ycyhjdXJyZW50KTtcbiAgICAgIGlmIChpbm5lckVycm9ycykge1xuICAgICAgICBhZGRWYWxpZGF0aW9uRXJyb3JzKGlubmVyRXJyb3JzLCBhY2N1bXVsYXRvcik7XG4gICAgICB9O1xuICAgICAgcmV0dXJuIGFjY3VtdWxhdG9yO1xuICAgIH0sIDxWYWxpZGF0aW9uRXJyb3JzPnt9XG4gICk7XG4gIHJldHVybiBPYmplY3QudmFsdWVzKGVycm9ycykubGVuZ3RoID09PSAwID8gbnVsbCA6IGVycm9ycztcbn07XG5cbmZ1bmN0aW9uIGFkZFZhbGlkYXRpb25FcnJvcnMoYWRkaXRpb25FcnJvcnM6IFZhbGlkYXRpb25FcnJvcnMsIGN1cnJlbnRFcnJvcnM6IFZhbGlkYXRpb25FcnJvcnMpIHtcbiAgT2JqZWN0LmVudHJpZXMoYWRkaXRpb25FcnJvcnMpLmZvckVhY2goXG4gICAgZW50cnkgPT4gY3VycmVudEVycm9yc1tlbnRyeVswXV0gPSBlbnRyeVsxXVxuICApO1xufSJdfQ==